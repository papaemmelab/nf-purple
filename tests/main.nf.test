nextflow_pipeline {

    name "Test Workflow main.nf"
    script "main.nf"

    test("Should run Main.nf with failures on the purple step") {

        when {
            params {
                tumor = "TEST"
                tumorBam = "${projectDir}/tests/data/tumor.bam"
                outdir = "${projectDir}/tests/outdir"
                refGenome = "${projectDir}/tests/data/reference.fasta"
            }
        }

        then {
            assert pipeline.failed
            assert pipeline.exitStatus == 1
            assert pipeline.errorReport.contains("[ERROR]")
        }

    }

}
